<!doctype html><html lang="da"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Historik – Arbejdskort</title>
<link rel="stylesheet" href="css/style.css">
</head><body>
<div class="topbar"><div class="wrap"><div>Historik – Arbejdskort</div></div></div>
<div class="wrap card">
  <div class="row">
    <div><label>Brugernavn</label><input id="hu" placeholder="brugernavn"></div>
    <div>
      <label>Periode</label>
      <select id="hd"><option value="7">7 dage</option><option value="30">30 dage</option></select>
    </div>
  </div>
  <div style="margin-top:8px"><button class="btn" id="hgo">Hent</button></div>
  <table style="margin-top:8px" id="ht"><thead><tr><th>Dato</th><th>Kunde</th><th>Art</th><th>Status</th></tr></thead><tbody></tbody></table>
</div>
<script>
const $=s=>document.querySelector(s);
document.getElementById('hgo').addEventListener('click', async ()=>{
  const u=$('#hu').value.trim().toLowerCase(); const d=$('#hd').value;
  const r=await fetch(`/api/cards?user=${encodeURIComponent(u)}&sinceDays=${d}`); const list=await r.json();
  const tb=$('#ht tbody'); tb.innerHTML='';
  list.forEach(c=>{ const tr=document.createElement('tr'); tr.innerHTML=`<td>${c.dateISO.slice(0,10)}</td><td>${c.fields.kunde||''}</td><td>${c.fields.arbejdet_art||''}</td><td>${c.sent?'Sendt':'Gemt'}</td>`; tb.append(tr); });
});
</script>
</body></html>
