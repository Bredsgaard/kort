<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Admin – Arbejdskort</title>
  <link rel="stylesheet" href="./css/style.css">
  <script src="./api/_util.js"></script>
  <script src="./api/login.js"></script>
  <script src="./api/settings.js"></script>
</head>
<body>
  <div class="header header--brand">
    <h1 id="apptitle">Arbejdskort – Admin</h1>
    <div class="nav">
      <a class="button ghost" href="./index.html">Medarbejder</a>
      <button id="logoutBtn" class="button ghost">Log ud</button>
    </div>
  </div>

  <div class="container">
    <div id="login" class="card card--center">
      <h3>Admin-login</h3>
      <div class="grid">
        <div class="field half"><label>Brugernavn</label><input id="u" class="input" placeholder="fx Bonde"></div>
        <div class="field half"><label>Kode</label><input id="p" class="input" type="password" placeholder="****"></div>
      </div>
      <div style="margin-top:12px;"><button id="loginBtn" class="button primary">Log ind</button></div>
      <small class="hint">Standard kode: 0705 (kan ændres i backend i næste fase).</small>
    </div>

    <div id="adminUI" style="display:none;"></div>
  </div>

<script>
ensureDefaults(); setHeaderTitle(document.querySelector('#apptitle'));
const sess=getSession(); const loginBox=document.querySelector('#login'); const adminBox=document.querySelector('#adminUI');

if(sess && sess.role==='admin'){ loginBox.style.display='none'; adminBox.style.display='block'; buildAdminUI(adminBox); }

document.querySelector('#loginBtn').onclick=async()=>{
  const u=document.querySelector('#u').value.trim();
  const p=document.querySelector('#p').value.trim();
  const s=await adminLogin(u,p);
  if(!s) return alert('Forkert admin-login.');
  location.reload();
};

document.querySelector('#logoutBtn').onclick=logout;

// Prefill brugernavn via ?u=Bonde (valgfrit)
(function(){
  const params = new URLSearchParams(location.search);
  const u = params.get('u');
  if (u) {
    const un = document.getElementById('u'); if (un) un.value = u;
    const pw = document.getElementById('p'); if (pw) pw.focus();
    history.replaceState({}, document.title, location.pathname);
  }
})();
</script>
</body>
</html>


